// ModalColorUpdate.js
import React, { useState, useEffect } from 'react';
import { useDispatch } from 'react-redux';
import { Button, Modal, Form, Input, Select, message } from 'antd';
import { detail, update } from '../../../../store/slice/ChatLieuReducer';

// ... Import statements

const ModalMaterialUpdate = ({ isOpen, onCancel, materials }) => {
    const dispatch = useDispatch();
    const [form] = Form.useForm();
    const [id, setId] = useState("")
    const [code, setCode] = useState('');
    const [name, setName] = useState('');
    const [description, setDescription] = useState('');
    const [status, setStatus] = useState('');

    useEffect(() => {
        console.log("material:", materials);
        if (materials) {
            setId(materials.id);
            setCode(materials.code);
            setName(materials.name);
            setStatus(materials.status); // Ensure status is a string
            setDescription(materials.description);
            console.log("id", materials.id)
        }
    }, [materials]);


    const handleInputChange = (e) => {
        const { name, value } = e.target;
        if (name === "status") {
            setStatus(parseInt(value));
        }
        // else if (name === "code") {
        //   setCode(value);
        // }
        else if (name === "name") {
            setName(value);
        } else if (name === "description") {
            setDescription(value);
        }
    };


    const handleOk = async () => {


        try {
            const formData = {
                id: id,
                code: code,
                name: name,
                description: description,
                createdBy: 1,
                updated_by: 1,
                status: 1, 
            };
            setConfirmLoading(true);
            await dispatch(update(formData));
            message.success("Sửa màu thành công");
            onCancel();

            form.resetFields();
        } catch (error) {
            message.error("Failed to update size");
        } finally {
            onCancel();
            form.resetFields();

            setConfirmLoading(false);
        }

    }

    return (

        <Modal
            title="Update Matertial"
            visible={isOpen}
            footer={[
                <Button key="cancel" onClick={onCancel}>
                    Cancel
                </Button>,
                <Button key="ok" type="primary"
                    onClick={handleOk}
                >
                    OK
                </Button>,
            ]}
        >
            <form>
                <h4>ID:</h4>
                <Input
                    name="id"
                    label="id:"
                    disabled
                />
                <h4>Mã Chất Liêu:</h4>
                <Input
                    name="code"
                    label="Mã màu:"
                    placeholder="Nhập mã màu"
                    onChange={(e) => handleInputChange({
                        target: {
                            name: 'code', value: e.target.value
                        }
                    })}

                />
                <h4 className="mt-3">Tên Chất Liệu:</h4>
                <Input
                    name="name"
                    label="Name:"
                    placeholder="Input name material"
                    onChange={(e) => handleInputChange({
                        target: {
                            name: 'name', value: e.target.value
                        }
                    })}
                />
                <h4 className="mt-3">Mô tả chất liệu:</h4>
                <Input
                    name="description"
                    label="Desciption:"
                    placeholder="Input description"
                    onChange={(e) => handleInputChange({
                        target: {
                            name: 'description', value: e.target.value
                        }
                    })}
                />
                <div className="mt-3 d-flex">
                    <h4>Trạng thái:</h4>
                    <Select className="ms-4"
                        value={status == 0 ? "Hết Hàng" : "Còn Hàng"}
                        disabled
                    >
                    </Select>
                </div>
            </form>
        </Modal>
    );
};
export default ModalMaterialUpdate;
